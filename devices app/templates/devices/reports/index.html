{% extends 'base.html' %}
{% load static %}

{% block title %}Device Reports - PIMS{% endblock %}

{% block extra_css %}
<style>
/* Device Reports Styling - Parliament Design System */
.reports-container {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    min-height: 100vh;
    padding: 2rem 0;
}

.page-header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.page-title {
    color: #1e3a8a;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.page-subtitle {
    color: #64748b;
    margin-bottom: 0;
}

.stats-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(30, 58, 138, 0.15);
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    font-size: 1.5rem;
    color: white;
}

.stat-icon.total { background: linear-gradient(135deg, #3b82f6, #2563eb); }
.stat-icon.available { background: linear-gradient(135deg, #10b981, #059669); }
.stat-icon.assigned { background: linear-gradient(135deg, #f59e0b, #d97706); }
.stat-icon.maintenance { background: linear-gradient(135deg, #ef4444, #dc2626); }

.stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #64748b;
    font-size: 0.875rem;
    font-weight: 500;
}

.reports-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
}

.report-category {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    overflow: hidden;
}

.category-header {
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
    color: white;
    padding: 1.5rem;
}

.category-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.category-desc {
    margin: 0;
    opacity: 0.9;
    font-size: 0.875rem;
}

.report-list {
    padding: 1.5rem;
}

.report-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    border: 1px solid rgba(203, 213, 225, 0.3);
    border-radius: 8px;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
    background: rgba(248, 250, 252, 0.5);
}

.report-item:hover {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(59, 130, 246, 0.3);
    transform: translateY(-1px);
}

.report-item:last-child {
    margin-bottom: 0;
}

.report-icon {
    width: 50px;
    height: 50px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    font-size: 1.25rem;
    color: white;
}

.report-icon.bg-primary { background: linear-gradient(135deg, #3b82f6, #2563eb); }
.report-icon.bg-success { background: linear-gradient(135deg, #10b981, #059669); }
.report-icon.bg-warning { background: linear-gradient(135deg, #f59e0b, #d97706); }
.report-icon.bg-danger { background: linear-gradient(135deg, #ef4444, #dc2626); }
.report-icon.bg-info { background: linear-gradient(135deg, #06b6d4, #0891b2); }
.report-icon.bg-secondary { background: linear-gradient(135deg, #6b7280, #4b5563); }

.report-info {
    flex: 1;
}

.report-name {
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 0.25rem;
    font-size: 1rem;
}

.report-description {
    color: #64748b;
    font-size: 0.875rem;
    margin-bottom: 0.5rem;
}

.report-stats {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.stat-item {
    font-size: 0.75rem;
    color: #6b7280;
    background: rgba(243, 244, 246, 0.8);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
}

.report-actions {
    margin-left: 1rem;
}

.btn-report {
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 500;
    transition: all 0.3s ease;
    border: 1px solid;
}

.btn-outline-primary:hover {
    background: #3b82f6;
    border-color: #3b82f6;
    transform: translateY(-1px);
}

.btn-outline-success:hover {
    background: #10b981;
    border-color: #10b981;
    transform: translateY(-1px);
}

.btn-outline-warning:hover {
    background: #f59e0b;
    border-color: #f59e0b;
    transform: translateY(-1px);
}

.quick-actions {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.quick-actions-title {
    color: #1e3a8a;
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.quick-actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.quick-action {
    background: rgba(248, 250, 252, 0.8);
    border: 1px solid rgba(203, 213, 225, 0.3);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    transition: all 0.3s ease;
    text-decoration: none;
    color: inherit;
}

.quick-action:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(59, 130, 246, 0.3);
    transform: translateY(-2px);
    text-decoration: none;
    color: inherit;
}

.quick-action-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
    color: #3b82f6;
}

.quick-action-title {
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 0.25rem;
}

.quick-action-desc {
    font-size: 0.875rem;
    color: #64748b;
}

/* Responsive Design */
@media (max-width: 768px) {
    .reports-container {
        padding: 1rem 0;
    }
    
    .reports-grid {
        grid-template-columns: 1fr;
    }
    
    .report-item {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
    
    .report-icon {
        margin-right: 0;
        margin-bottom: 0.5rem;
    }
    
    .report-actions {
        margin-left: 0;
        margin-top: 0.5rem;
    }
    
    .quick-actions-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="reports-container">
    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <h1 class="page-title">
                        <i class="bi bi-graph-up me-2"></i>
                        Device Reports & Analytics
                    </h1>
                    <p class="page-subtitle">
                        Comprehensive reporting and analytics for Bangladesh Parliament Secretariat IT inventory
                    </p>
                </div>
                <div class="text-end">
                    <div class="badge bg-primary fs-6">
                        <i class="bi bi-geo-alt me-1"></i>
                        Dhaka, Bangladesh
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Overview -->
        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-icon total">
                    <i class="bi bi-laptop"></i>
                </div>
                <div class="stat-number">{{ total_devices }}</div>
                <div class="stat-label">Total Devices</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon available">
                    <i class="bi bi-check-circle"></i>
                </div>
                <div class="stat-number">{{ available_devices }}</div>
                <div class="stat-label">Available</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon assigned">
                    <i class="bi bi-person-check"></i>
                </div>
                <div class="stat-number">{{ assigned_devices }}</div>
                <div class="stat-label">Assigned</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon maintenance">
                    <i class="bi bi-tools"></i>
                </div>
                <div class="stat-number">{{ maintenance_devices }}</div>
                <div class="stat-label">In Maintenance</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <h3 class="quick-actions-title">
                <i class="bi bi-lightning-charge"></i>
                Quick Actions
            </h3>
            <div class="quick-actions-grid">
                <a href="{% url 'devices:bulk_export' %}" class="quick-action">
                    <div class="quick-action-icon">
                        <i class="bi bi-download"></i>
                    </div>
                    <div class="quick-action-title">Bulk Export</div>
                    <div class="quick-action-desc">Export multiple devices</div>
                </a>
                <a href="{% url 'devices:filter' %}" class="quick-action">
                    <div class="quick-action-icon">
                        <i class="bi bi-funnel"></i>
                    </div>
                    <div class="quick-action-title">Advanced Filter</div>
                    <div class="quick-action-desc">Filter and analyze devices</div>
                </a>
                <a href="{% url 'devices:dashboard' %}" class="quick-action">
                    <div class="quick-action-icon">
                        <i class="bi bi-speedometer2"></i>
                    </div>
                    <div class="quick-action-title">Dashboard</div>
                    <div class="quick-action-desc">Real-time overview</div>
                </a>
            </div>
        </div>

        <!-- Report Categories -->
        <div class="reports-grid">
            <!-- Inventory Reports -->
            <div class="report-category">
                <div class="category-header">
                    <h3 class="category-title">
                        <i class="bi bi-clipboard-data"></i>
                        Inventory Reports
                    </h3>
                    <p class="category-desc">Standard inventory and asset tracking reports</p>
                </div>
                
                <div class="report-list">
                    <div class="report-item">
                        <div class="report-icon bg-primary">
                            <i class="bi bi-laptop"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Complete Device Inventory</div>
                            <div class="report-description">Comprehensive list of all devices with specifications, status, and location details</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-laptop me-1"></i>
                                    {{ total_devices }} devices
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-tags me-1"></i>
                                    {{ total_categories }} categories
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <div class="btn-group">
                                <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="bi bi-download me-1"></i>Generate
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="{% url 'devices:report_inventory' %}?format=pdf">
                                        <i class="bi bi-file-pdf me-2"></i>PDF Report
                                    </a></li>
                                    <li><a class="dropdown-item" href="{% url 'devices:report_inventory' %}?format=excel">
                                        <i class="bi bi-file-excel me-2"></i>Excel Workbook
                                    </a></li>
                                    <li><a class="dropdown-item" href="{% url 'devices:report_inventory' %}?format=csv">
                                        <i class="bi bi-filetype-csv me-2"></i>CSV Data
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="report-item">
                        <div class="report-icon bg-success">
                            <i class="bi bi-check-circle"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Available Devices</div>
                            <div class="report-description">List of all available devices ready for assignment or deployment</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-check-circle me-1"></i>
                                    {{ available_devices }} available
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-percent me-1"></i>
                                    {{ availability_rate }}% availability
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <a href="{% url 'devices:available' %}?export=pdf" class="btn btn-outline-success">
                                <i class="bi bi-download me-1"></i>Export
                            </a>
                        </div>
                    </div>

                    <div class="report-item">
                        <div class="report-icon bg-warning">
                            <i class="bi bi-tools"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Maintenance Status</div>
                            <div class="report-description">Devices currently under maintenance with schedules and expected completion</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-tools me-1"></i>
                                    {{ maintenance_devices }} in maintenance
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-calendar-check me-1"></i>
                                    {{ overdue_maintenance }} overdue
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <a href="{% url 'devices:maintenance' %}?export=pdf" class="btn btn-outline-warning">
                                <i class="bi bi-download me-1"></i>Export
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category & Location Reports -->
            <div class="report-category">
                <div class="category-header">
                    <h3 class="category-title">
                        <i class="bi bi-diagram-3"></i>
                        Category & Location Analysis
                    </h3>
                    <p class="category-desc">Breakdown by device categories and location distribution</p>
                </div>
                
                <div class="report-list">
                    <div class="report-item">
                        <div class="report-icon bg-info">
                            <i class="bi bi-tags"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Devices by Category</div>
                            <div class="report-description">Statistical breakdown of devices organized by categories and subcategories</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-tags me-1"></i>
                                    {{ total_categories }} categories
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-diagram-2 me-1"></i>
                                    {{ total_subcategories }} subcategories
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <a href="{% url 'devices:report_category' %}" class="btn btn-outline-info">
                                <i class="bi bi-graph-up me-1"></i>Analyze
                            </a>
                        </div>
                    </div>

                    <div class="report-item">
                        <div class="report-icon bg-secondary">
                            <i class="bi bi-geo-alt"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Location Distribution</div>
                            <div class="report-description">Device allocation across buildings, floors, and offices within Parliament</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-building me-1"></i>
                                    {{ total_locations }} locations
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-geo-alt me-1"></i>
                                    {{ locations_used }} occupied
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <a href="{% url 'devices:report_location' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-map me-1"></i>View Map
                            </a>
                        </div>
                    </div>

                    <div class="report-item">
                        <div class="report-icon bg-danger">
                            <i class="bi bi-shield-exclamation"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-name">Warranty & Depreciation</div>
                            <div class="report-description">Warranty status tracking and asset depreciation analysis for financial planning</div>
                            <div class="report-stats">
                                <span class="stat-item">
                                    <i class="bi bi-shield-check me-1"></i>
                                    {{ warranty_active }} under warranty
                                </span>
                                <span class="stat-item">
                                    <i class="bi bi-exclamation-triangle me-1"></i>
                                    {{ warranty_expiring }} expiring soon
                                </span>
                            </div>
                        </div>
                        <div class="report-actions">
                            <div class="btn-group">
                                <button class="btn btn-outline-danger dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="bi bi-download me-1"></i>Generate
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="{% url 'devices:report_warranty' %}">
                                        <i class="bi bi-shield-check me-2"></i>Warranty Report
                                    </a></li>
                                    <li><a class="dropdown-item" href="{% url 'devices:report_depreciation' %}">
                                        <i class="bi bi-graph-down me-2"></i>Depreciation Analysis
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Reports page JavaScript functionality
document.addEventListener('DOMContentLoaded', function() {
    // Initialize tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    // Handle dropdown selections
    document.querySelectorAll('.dropdown-item').forEach(item => {
        item.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href && !href.startsWith('#')) {
                window.open(href, '_blank');
            }
        });
    });

    // Add loading states to report buttons
    document.querySelectorAll('.btn-outline-primary, .btn-outline-success, .btn-outline-warning, .btn-outline-info, .btn-outline-secondary, .btn-outline-danger').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (this.getAttribute('href') && !this.getAttribute('href').startsWith('#')) {
                const originalText = this.innerHTML;
                this.innerHTML = '<i class="bi bi-hourglass-split me-1"></i>Generating...';
                this.disabled = true;
                
                setTimeout(() => {
                    this.innerHTML = originalText;
                    this.disabled = false;
                }, 3000);
            }
        });
    });
});
</script>
{% endblock %}